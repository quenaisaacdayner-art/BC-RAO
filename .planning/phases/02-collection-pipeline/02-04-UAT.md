---
status: complete
phase: 02-collection-pipeline
source: 02-04-PLAN.md
started: 2026-02-10T23:00:00Z
updated: 2026-02-10T23:05:00Z
---

## Current Test

[testing complete]

## Tests

### 1. Collection Page — Idle State with Start Button
expected: Navigate to /dashboard/campaigns/[id]/collect for a campaign with no collected posts. You see a "Collect Data" heading, campaign name, "Ready to Collect" card with target subreddits as badges, and a "Start Collection (5 remaining)" button.
result: pass

### 2. Campaign Detail — "Collect Data" Button
expected: On the campaign detail page (/dashboard/campaigns/[id]), there's a "Collect Data" button with a database icon in the top-right action area. Clicking it navigates to the collection page.
result: pass

### 3. Build Passes Without Errors
expected: The frontend builds successfully with no TypeScript errors. All four new components (PostGrid, PostFilters, PostDetailModal, FunnelStats) compile cleanly.
result: pass

### 4. Post Card Layout (Code Review)
expected: PostGrid component renders cards in a 3-column grid on large screens, 2-column on medium, 1-column on mobile. Each card shows: title (line-clamp-2), text snippet (line-clamp-3), archetype badge with color coding (blue=Journey, purple=ProblemSolution, green=Feedback), subreddit badge (r/name), and success score as "X.X/10" with a small progress bar. Cards have cursor-pointer and hover:shadow-lg.
result: pass

### 5. Filter Bar Layout (Code Review)
expected: PostFilters component renders three filters in a horizontal row on desktop (stacked on mobile): archetype dropdown (All/Journey/Problem-Solution/Feedback), subreddit dropdown (All + campaign subreddits), and score range slider (0-10, step 0.5) with current range displayed. Filters persist to URL params.
result: pass

### 6. Post Detail Modal (Code Review)
expected: PostDetailModal uses Shadcn Dialog with max-w-3xl. Shows: title, archetype badge (colored), subreddit badge, score badge, full post text (whitespace-pre-wrap, scrollable), 2x2 metadata grid (author, date, upvote ratio, comments), success score with large progress bar, and archetype description. No LLM reasoning exposed.
result: pass

### 7. Funnel Stats (Code Review)
expected: FunnelStats shows three-step funnel (Scraped -> Passed Regex -> Classified) with large numbers and arrows. Filter rate percentage displayed. Expandable "Filter Breakdown" section. Archetype distribution as badge pills with counts. Subreddit distribution grid.
result: pass

### 8. Page Detects Existing Posts on Revisit
expected: The collection page checks /api/campaigns/[id]/collection-stats on mount. If classified > 0, it shows the results view directly (skips idle state). If no posts, shows idle view with "Start Collection".
result: pass

### 9. "Collect More" Button in Results View
expected: In the results view, there's a "Collect More (4 remaining)" button at the top-right. Clicking it triggers a new collection without replacing existing posts.
result: pass

### 10. Pagination Controls
expected: PostGrid shows "Showing X-Y of Z" text and Previous/Next buttons below the grid. Previous disabled on page 1, Next disabled on last page. 20 posts per page.
result: pass

### 11. API Proxy Routes Exist
expected: Two API proxy routes created: /api/campaigns/[id]/posts (GET, forwards to FastAPI) and /api/campaigns/[id]/collection-stats (GET, forwards to FastAPI). Both routes exist and handle authentication forwarding.
result: pass

## Summary

total: 11
passed: 11
issues: 0
pending: 0
skipped: 0

## Gaps

[none yet]
