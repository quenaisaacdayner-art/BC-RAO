---
phase: 01-foundation-core-setup
plan: 06
type: execute
wave: 4
depends_on: ["01-05"]
files_modified:
  - bc-rao-frontend/app/(dashboard)/campaigns/page.tsx
  - bc-rao-frontend/app/(dashboard)/campaigns/new/page.tsx
  - bc-rao-frontend/app/(dashboard)/campaigns/[id]/page.tsx
  - bc-rao-frontend/app/(dashboard)/campaigns/[id]/edit/page.tsx
  - bc-rao-frontend/components/forms/campaign-form.tsx
  - bc-rao-frontend/components/forms/subreddit-autocomplete.tsx
  - bc-rao-frontend/components/campaigns/campaign-card.tsx
  - bc-rao-frontend/components/campaigns/delete-campaign-dialog.tsx
  - bc-rao-frontend/lib/validations/campaign.ts
  - bc-rao-frontend/hooks/use-debounce.ts
autonomous: false

must_haves:
  truths:
    - "User can create a campaign with name, product context, keywords (5-15), and target subreddits"
    - "Subreddit input autocompletes by querying Reddit as user types"
    - "User can view list of campaigns with inline stats showing zeros"
    - "User can edit campaign keywords, subreddits, and status"
    - "User can delete a campaign with confirmation dialog"
    - "Empty campaign list shows quick-start card with CTA"
  artifacts:
    - path: "bc-rao-frontend/app/(dashboard)/campaigns/page.tsx"
      provides: "Campaign list page with empty state"
      min_lines: 30
    - path: "bc-rao-frontend/app/(dashboard)/campaigns/new/page.tsx"
      provides: "Campaign creation page"
      min_lines: 10
    - path: "bc-rao-frontend/components/forms/campaign-form.tsx"
      provides: "Campaign form with Zod validation"
      contains: "zodResolver"
    - path: "bc-rao-frontend/components/forms/subreddit-autocomplete.tsx"
      provides: "Reddit subreddit search with debounce"
      contains: "subreddits/search"
    - path: "bc-rao-frontend/components/campaigns/campaign-card.tsx"
      provides: "Campaign card with inline stats"
      contains: "Posts.*Drafts.*Monitors"
    - path: "bc-rao-frontend/lib/validations/campaign.ts"
      provides: "Zod schema for campaign form"
      exports: ["campaignSchema"]
  key_links:
    - from: "bc-rao-frontend/components/forms/campaign-form.tsx"
      to: "bc-rao-frontend/lib/validations/campaign.ts"
      via: "Zod schema import for form validation"
      pattern: "campaignSchema"
    - from: "bc-rao-frontend/components/forms/campaign-form.tsx"
      to: "bc-rao-frontend/lib/api.ts"
      via: "API call to create/update campaign"
      pattern: "api.*campaign|fetch.*campaign"
    - from: "bc-rao-frontend/components/forms/subreddit-autocomplete.tsx"
      to: "bc-rao-frontend/hooks/use-debounce.ts"
      via: "Debounced search query"
      pattern: "useDebounce"
    - from: "bc-rao-frontend/app/(dashboard)/campaigns/page.tsx"
      to: "bc-rao-frontend/components/campaigns/campaign-card.tsx"
      via: "Rendering campaign list"
      pattern: "<CampaignCard"
---

<objective>
Campaign UI: Create, view, edit, and delete campaigns from the dashboard with subreddit autocomplete, keyword validation, and proper empty states.

Purpose: This completes the full campaign management user experience — the primary Phase 1 deliverable alongside auth.
Output: Working campaign CRUD UI with subreddit search, keyword input, list view with stats, edit/delete flows.
</objective>

<execution_context>
@C:\Users\quena\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\quena\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-foundation-core-setup/01-RESEARCH.md
@.planning/phases/01-foundation-core-setup/01-05-SUMMARY.md
@bc-rao-system-spec_1.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Campaign form with subreddit autocomplete and keyword validation</name>
  <files>
    bc-rao-frontend/lib/validations/campaign.ts
    bc-rao-frontend/hooks/use-debounce.ts
    bc-rao-frontend/components/forms/subreddit-autocomplete.tsx
    bc-rao-frontend/components/forms/campaign-form.tsx
    bc-rao-frontend/app/(dashboard)/campaigns/new/page.tsx
  </files>
  <action>
**Per user locked decisions:**
- Single page form with ALL fields visible (not wizard/stepper)
- Subreddit input: search + autocomplete querying Reddit
- Keywords: textarea with comma-separated values, system splits and validates 5-15
- Post-creation redirect: Claude's discretion -> redirect to campaign list with success toast

**lib/validations/campaign.ts:**
- Zod schema for campaign creation:
  - name: string, min 1, max 100
  - product_context: string, min 10, "Describe your product and target audience"
  - product_url: string (URL) or empty string, optional
  - keywords: string (comma-separated textarea input)
    - Custom refinement: split by comma, trim, filter empty, check count >= 5 and <= 15
    - Error: "Between 5 and 15 keywords required"
  - target_subreddits: array of strings, min 1
    - Error: "At least one subreddit required"
- Export `campaignSchema` and inferred type `CampaignFormValues`
- Separate `campaignUpdateSchema` (all fields optional, same validations when present)

**hooks/use-debounce.ts:**
- Standard debounce hook: `useDebounce<T>(value: T, delay: number): T`
- Returns debounced value after delay ms of no changes

**components/forms/subreddit-autocomplete.tsx:**
- "use client" component
- Props: `selected: string[]`, `onSelect: (subs: string[]) => void`, `maxItems?: number`
- Text input with dropdown results
- On input change: debounce 300ms, then fetch Reddit API:
  `https://www.reddit.com/subreddits/search.json?q=${query}&limit=10`
  with User-Agent header "BC-RAO/1.0"
- Display results as dropdown items: `r/{name} ({subscribers} members)`
- On click result: add to selected list (shown as tags/chips below input)
- Selected subreddits shown as removable chips (click X to remove)
- Input clears after selection
- Hide dropdown when clicking outside (useRef + useEffect)
- Handle Reddit API errors gracefully (show nothing, don't crash)

**components/forms/campaign-form.tsx:**
- "use client" component
- Props: `mode: "create" | "edit"`, `defaultValues?: CampaignFormValues`, `campaignId?: string`
- Uses React Hook Form with `zodResolver(campaignSchema)`
- Shadcn Form components (FormField, FormItem, FormLabel, FormControl, FormDescription, FormMessage)
- Field order (Claude's discretion):
  1. Campaign Name (Input)
  2. Product Context (Textarea, 4 rows, description: "Describe your product, target audience, and value proposition")
  3. Product URL (Input, optional, placeholder: "https://yourproduct.com")
  4. Keywords (Textarea, 2 rows, placeholder: "saas, startup, growth, marketing, tools", description: "Comma-separated, 5-15 required")
  5. Target Subreddits (SubredditAutocomplete component, integrated via Controller)
- Submit button: "Create Campaign" or "Save Changes"
- Loading state during submission
- On submit (create mode):
  - Parse keywords: split by comma, trim, filter empty
  - POST to /v1/campaigns via API client (include JWT from Supabase session)
  - On success: redirect to /dashboard/campaigns with toast "Campaign created successfully"
  - On error: show error inline or via toast (Claude's discretion -> use toast via sonner for API errors, inline for validation)
- On submit (edit mode):
  - PATCH to /v1/campaigns/{id}
  - On success: redirect to campaign detail or list with toast

**app/(dashboard)/campaigns/new/page.tsx:**
- Page wrapper rendering CampaignForm in create mode
- Page title/heading: "Create Campaign"
- Back link to /dashboard/campaigns

Install sonner for toast notifications: `npm install sonner` and add `<Toaster />` to root layout or dashboard layout.
  </action>
  <verify>
1. `npm run build` succeeds
2. Visit /dashboard/campaigns/new — form renders with all 5 fields
3. Subreddit input: type "saas" -> dropdown appears after 300ms with Reddit results
4. Select subreddit -> chip appears, input clears
5. Submit with < 5 keywords -> validation error shown
6. Submit valid form -> campaign created, redirect to list with toast
  </verify>
  <done>Campaign creation form works with all fields visible, subreddit autocomplete queries Reddit with debounce, keyword textarea validates 5-15 count, successful creation redirects with toast.</done>
</task>

<task type="auto">
  <name>Task 2: Campaign list, detail, edit, and delete pages</name>
  <files>
    bc-rao-frontend/components/campaigns/campaign-card.tsx
    bc-rao-frontend/components/campaigns/delete-campaign-dialog.tsx
    bc-rao-frontend/app/(dashboard)/campaigns/page.tsx
    bc-rao-frontend/app/(dashboard)/campaigns/[id]/page.tsx
    bc-rao-frontend/app/(dashboard)/campaigns/[id]/edit/page.tsx
  </files>
  <action>
**Per user locked decisions:**
- Campaign list cards show stats inline with zeros: "Posts: 0 | Drafts: 0 | Monitors: 0"
- Empty state: quick-start card explaining campaigns + CTA
- Professional, direct tone — no emoji, no fluff
- Balanced information density (Vercel dashboard style)

**components/campaigns/campaign-card.tsx:**
- Shadcn Card component showing:
  - Campaign name (CardTitle)
  - Status badge (active=green, paused=yellow, archived=gray)
  - Product context (truncated to 2 lines)
  - Keywords shown as small tags/badges (show first 5, "+N more" if > 5)
  - Target subreddits as `r/name` text
  - Stats row at bottom: `Posts: 0 | Drafts: 0 | Monitors: 0` (per user decision, show zeros)
  - Actions: Edit button, Delete button (or kebab menu with Edit/Delete)
- On click card: navigate to campaign detail page
- Balanced density: enough info to be useful, not overwhelming

**components/campaigns/delete-campaign-dialog.tsx:**
- AlertDialog (Shadcn) for delete confirmation
- "Are you sure you want to delete this campaign? This action cannot be undone. All related data will be permanently deleted."
- Confirm button: "Delete Campaign" (destructive variant)
- Cancel button: "Cancel"
- On confirm: DELETE to /v1/campaigns/{id}, then refresh list or redirect

**app/(dashboard)/campaigns/page.tsx:**
- Fetch campaigns from API (GET /v1/campaigns with auth token)
- Page header: "Campaigns" with "New Campaign" button
- **If no campaigns (empty state per user decision):**
  - Quick-start card centered on page:
    - Heading: "No campaigns yet"
    - Body: "Campaigns organize your Reddit research by product. Create a campaign to start collecting community data."
    - CTA: "Create your first campaign" button -> /dashboard/campaigns/new
  - No skeleton, no placeholder metrics
- **If campaigns exist:**
  - Responsive grid of CampaignCards: 1 col on mobile, 2 cols on md, 3 cols on lg
  - Stats show actual counts (zeros for new campaigns is expected and intentional)

**app/(dashboard)/campaigns/[id]/page.tsx:**
- Campaign detail page
- Fetch campaign with stats from GET /v1/campaigns/{id}
- Show all campaign fields:
  - Name, status, product context (full), product URL (link)
  - Keywords as tag badges
  - Subreddits list
  - Stats: Posts collected, Drafts generated, Active monitors (with zeros)
  - Created/updated dates
- Action buttons: "Edit Campaign", "Delete Campaign"
- Back link to /dashboard/campaigns
- Placeholder section: "Collection, analysis, and generation features coming in future phases." (subtle text at bottom)

**app/(dashboard)/campaigns/[id]/edit/page.tsx:**
- Renders CampaignForm in edit mode with `defaultValues` loaded from API
- Fetch campaign data, pass as props
- Page title: "Edit Campaign"
- Back link to campaign detail

Add campaign routes to next.config if needed. Ensure all API calls include the Supabase JWT token from the session.
  </action>
  <verify>
1. `npm run build` succeeds
2. Visit /dashboard/campaigns — empty state shows when no campaigns
3. Create a campaign via /new -> appears in list
4. Campaign card shows name, status, keywords, stats with zeros
5. Click card -> detail page with all fields
6. Click Edit -> form pre-filled, save updates campaign
7. Click Delete -> confirmation dialog, confirm deletes campaign
8. After delete, redirect to campaigns list
  </verify>
  <done>Campaign list with cards (stats inline with zeros), empty state with CTA, detail page with full info, edit page with pre-filled form, delete with confirmation dialog. All professional tone, Vercel-style density.</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete Phase 1 UI: Auth flow (signup/login), dashboard with collapsible sidebar, dark/light mode, campaign CRUD (create with subreddit autocomplete, list with stats, edit, delete), overview page with empty states.</what-built>
  <how-to-verify>
1. Visit http://localhost:3000 — should redirect to /login
2. Click "Sign up" — create account with email/password/name
3. After signup, should redirect to /dashboard
4. Dashboard: collapsible sidebar with Overview and Campaigns links
5. Toggle dark/light mode from sidebar
6. Overview page: shows empty state card "Create a campaign to start collecting community data."
7. Navigate to Campaigns page: shows empty state
8. Click "Create your first campaign":
   - Fill name, product context (10+ chars), product URL
   - Type "saas" in subreddit field — autocomplete dropdown appears
   - Select a subreddit — appears as chip
   - Enter 5+ comma-separated keywords
   - Submit — redirects to campaign list with toast
9. Campaign appears in list with stats (Posts: 0 | Drafts: 0 | Monitors: 0)
10. Click campaign card — detail page shows all info
11. Edit campaign — change a keyword, save
12. Delete campaign — confirmation dialog, confirm deletion
13. Log out from sidebar user menu — redirected to /login
14. Close browser, reopen /dashboard — still logged in (JWT persists)
  </how-to-verify>
  <resume-signal>Type "approved" or describe any issues to fix</resume-signal>
</task>

</tasks>

<verification>
1. Full campaign lifecycle: create -> view in list -> view detail -> edit -> delete
2. Subreddit autocomplete fetches from Reddit API with debounce
3. Keyword validation enforces 5-15 count
4. Empty states use professional, direct language per user decision
5. Campaign cards show stats inline with zeros per user decision
6. Overview page hides stats sections when no data per user decision
7. Dark/light mode works from sidebar toggle
8. Sidebar collapses to icon-only mode per user decision
</verification>

<success_criteria>
- CAMP-01: User can create campaign with name, product context, product URL, keywords (5-15), and target subreddits
- CAMP-02: User can view list of campaigns with stats (posts collected, drafts generated, active monitors)
- CAMP-03: User can edit campaign keywords, subreddits, and status
- CAMP-04: User can delete a campaign (cascades to related data)
- All locked UI decisions implemented: sidebar, empty states, stats with zeros, professional tone
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-core-setup/01-06-SUMMARY.md`
</output>
